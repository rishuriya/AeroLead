<div class="container-fluid">
  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><%= link_to "Home", root_path %></li>
      <li class="breadcrumb-item"><%= link_to "Blog Posts", blog_posts_path %></li>
      <li class="breadcrumb-item active" aria-current="page"><%= @blog_post.title %></li>
    </ol>
  </nav>

  <div class="row">
    <!-- Main Content -->
    <div class="col-lg-9">
      <article class="card">
        <div class="card-body">
          <!-- Article Header -->
          <div class="mb-4">
            <h1 class="display-4 fw-bold mb-3"><%= @blog_post.title %></h1>

            <div class="d-flex flex-wrap align-items-center gap-3 mb-3">
              <!-- Status Badge -->
              <% if @blog_post.published? %>
                <span class="badge bg-success badge-status">
                  <i class="bi bi-check-circle"></i> Published
                </span>
              <% elsif @blog_post.draft? %>
                <span class="badge bg-warning badge-status">
                  <i class="bi bi-file-earmark"></i> Draft
                </span>
              <% else %>
                <span class="badge bg-secondary badge-status">
                  <i class="bi bi-archive"></i> Archived
                </span>
              <% end %>

              <!-- AI Model Badge -->
              <% if @blog_post.ai_model.present? %>
                <span class="badge bg-info">
                  <i class="bi bi-stars"></i> <%= @blog_post.ai_model.upcase %>
                </span>
              <% end %>
            </div>

            <!-- Meta Information -->
            <div class="d-flex flex-wrap align-items-center gap-4 text-muted">
              <span>
                <i class="bi bi-calendar3"></i>
                <%= @blog_post.published_at&.strftime("%B %d, %Y") || @blog_post.created_at.strftime("%B %d, %Y") %>
              </span>
              <span>
                <i class="bi bi-clock"></i>
                <%= @blog_post.reading_time %> min read
              </span>
              <span>
                <i class="bi bi-file-text"></i>
                <%= number_with_delimiter(@blog_post.word_count) %> words
              </span>
            </div>
          </div>

          <hr class="my-4">

          <!-- Excerpt (if present) -->
          <% if @blog_post.excerpt.present? %>
            <div class="lead mb-4 p-3 bg-light rounded">
              <%= @blog_post.excerpt %>
            </div>
          <% end %>

          <!-- Article Content -->
          <div class="article-content">
            <%= raw @blog_post.content_html %>
          </div>

          <!-- Metadata (if present) -->
          <% if @blog_post.metadata.present? %>
            <hr class="my-4">
            <div class="card bg-light">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-info-circle"></i> Article Metadata
                </h5>
                <pre class="mb-0"><%= JSON.pretty_generate(@blog_post.metadata) %></pre>
              </div>
            </div>
          <% end %>
        </div>

        <!-- Action Buttons -->
        <div class="card-footer bg-white">
          <div class="d-flex justify-content-between align-items-center">
            <div class="btn-group" role="group">
              <%= link_to edit_blog_post_path(@blog_post.slug), class: "btn btn-outline-primary" do %>
                <i class="bi bi-pencil"></i> Edit
              <% end %>

              <% if @blog_post.draft? %>
                <%= button_to publish_blog_post_path(@blog_post.slug), method: :post, class: "btn btn-outline-success" do %>
                  <i class="bi bi-upload"></i> Publish
                <% end %>
              <% elsif @blog_post.published? %>
                <%= button_to unpublish_blog_post_path(@blog_post.slug), method: :post, class: "btn btn-outline-warning" do %>
                  <i class="bi bi-download"></i> Unpublish
                <% end %>
              <% end %>

              <%= button_to blog_post_path(@blog_post.slug), method: :delete,
                  data: { confirm: "Are you sure you want to delete this post?" },
                  class: "btn btn-outline-danger" do %>
                <i class="bi bi-trash"></i> Delete
              <% end %>
            </div>

            <%= link_to blog_posts_path, class: "btn btn-secondary" do %>
              <i class="bi bi-arrow-left"></i> Back to Posts
            <% end %>
          </div>
        </div>
      </article>
    </div>

    <!-- Sidebar -->
    <div class="col-lg-3">
      <!-- Statistics Card -->
      <div class="card mb-3">
        <div class="card-header">
          <h6 class="mb-0">
            <i class="bi bi-bar-chart"></i> Statistics
          </h6>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <small class="text-muted">Created</small>
            <p class="mb-0"><%= @blog_post.created_at.strftime("%b %d, %Y %I:%M %p") %></p>
          </div>

          <% if @blog_post.published_at %>
            <div class="mb-3">
              <small class="text-muted">Published</small>
              <p class="mb-0"><%= @blog_post.published_at.strftime("%b %d, %Y %I:%M %p") %></p>
            </div>
          <% end %>

          <div class="mb-3">
            <small class="text-muted">Last Updated</small>
            <p class="mb-0"><%= @blog_post.updated_at.strftime("%b %d, %Y %I:%M %p") %></p>
          </div>

          <hr>

          <div class="mb-0">
            <small class="text-muted">Slug</small>
            <p class="mb-0 font-monospace small"><%= @blog_post.slug %></p>
          </div>
        </div>
      </div>

      <!-- Share Card -->
      <div class="card">
        <div class="card-header">
          <h6 class="mb-0">
            <i class="bi bi-share"></i> Share
          </h6>
        </div>
        <div class="card-body">
          <div class="input-group">
            <input type="text" class="form-control form-control-sm"
                   value="<%= blog_post_url(@blog_post.slug) %>"
                   id="shareUrl" readonly>
            <button class="btn btn-sm btn-outline-secondary" type="button"
                    onclick="navigator.clipboard.writeText(document.getElementById('shareUrl').value)">
              <i class="bi bi-clipboard"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .article-content {
    font-size: 1.1rem;
    line-height: 1.8;
  }

  .article-content h1, .article-content h2 {
    margin-top: 2rem;
    margin-bottom: 1rem;
  }

  .article-content h3, .article-content h4 {
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
  }

  .article-content p {
    margin-bottom: 1.25rem;
  }

  .article-content img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin: 1.5rem 0;
  }

  .article-content pre {
    background: #f8f9fa;
    padding: 1rem;
    border-radius: 6px;
    overflow-x: auto;
  }

  .article-content code {
    background: #f8f9fa;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    font-size: 0.9em;
  }

  .article-content blockquote {
    border-left: 4px solid #dee2e6;
    padding-left: 1rem;
    margin-left: 0;
    color: #6c757d;
  }

  .article-content ul, .article-content ol {
    margin-bottom: 1.25rem;
  }

  .article-content li {
    margin-bottom: 0.5rem;
  }

  .badge-status {
    font-size: 0.875rem;
    padding: 0.5rem 0.75rem;
  }
</style>
